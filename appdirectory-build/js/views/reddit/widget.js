define(["jquery","underscore","backbone","vm","events","masonry","modernizr","slides","collections/reddit","views/reddit/postview","views/reddit/albumview","views/reddit/pictureview","text!templates/loader.html"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){var p=n.View.extend({el:e("#reddit-widget"),initialize:function(){this.isLoading=!1,this.numberLoaded=0,this.loadCount=0,this.redditCollection=new a,this.redditCollection.subreddit=this.options.subreddit,t.bindAll(this,"checkScroll"),e(window).scroll(this.checkScroll)},render:function(){e(this.el).masonry({itemSelector:".box",columnWidth:10,isFitWidth:!0,isAnimated:!1,animationOptions:{duration:400}}),this.loadResults()},loadResults:function(){var n=this;this.numberLoaded=0,this.isLoading=!0,e("#ajax-loader").show(),this.redditCollection.fetch({success:function(e){n.loadCount=e.length,t.each(e.models,function(e){if(n.isImgur(e.get("url"))===!0)if(n.isImgurAlbum(e.get("url"))===!1)if(n.isImage(e.get("url"))===!0){var t=new f({model:e,parent:n}),r=t.render();n.appendPost(r)}else var i=new c({model:e,parent:n}),s=i.render();else var o=new l({model:e,parent:n}),u=o.render()})}})},appendPost:function(t){e(t.el).imagesLoaded(function(){e(t.options.parent.el).append(t.el).masonry("appended",e(t.el),!0),t.options.parent.isLoading=!1,e("#ajax-loader").hide()})},checkScroll:function(){console.log(this.isLoading);var t=100;!this.isLoading&&e(window).scrollTop()+e(window).height()+t>e(document).height()&&this.loadResults()},isImgurAlbum:function(e){return/[\/][a][\/]/.test(e)?!0:!1},isImage:function(e){return/(jpg|gif|png)/.test(e)?!0:!1},isImgur:function(e){return/imgur/.test(e)?!0:!1}});return p});var viewHelper={linkMod:function(e){return e}}